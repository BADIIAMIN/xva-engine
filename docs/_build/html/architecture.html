

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Architecture &amp; Design View &mdash; XVA / CCR / PFE Engine  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            XVA / CCR / PFE Engine
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Architecture &amp; Design View</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#high-level-component-diagram">High-Level Component Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="#core-class-diagram">Core Class Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="#orchestration-sequence">Orchestration Sequence</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">XVA / CCR / PFE Engine</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Architecture &amp; Design View</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/architecture.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="architecture-design-view">
<h1>Architecture &amp; Design View<a class="headerlink" href="#architecture-design-view" title="Link to this heading"></a></h1>
<section id="high-level-component-diagram">
<h2>High-Level Component Diagram<a class="headerlink" href="#high-level-component-diagram" title="Link to this heading"></a></h2>
<p class="plantuml">
<object data="_images/plantuml-86922573698dd9a95b6cee38f3a0c6ced1357f7f.svg" type="image/svg+xml" style="width:2690px;height:345px;background:#FFFFFF;">
<img src="_images/plantuml-86922573698dd9a95b6cee38f3a0c6ced1357f7f.png" alt="&#64;startuml XVA_Engine_HighLevel

title XVA / CCR / PFE Engine - High Level Architecture

skinparam componentStyle rectangle

package &quot;Configuration&quot; {
  [RunConfig]
}

package &quot;Orchestration&quot; {
  [EngineRunner]
  [WorkflowManager]
}

package &quot;Market Data&quot; {
  [MarketDataEnvironment]
  [MarketDataSource]
}

package &quot;Models &amp; Simulation&quot; {
  [RiskFactorModel]
  [CorrelationModel]
  [SimulationDriver]
  [TimeGrid]
  [RiskFactorCube]
}

package &quot;Instruments &amp; Pricing&quot; {
  [Instrument]
  [Portfolio]
  [PricingContext]
  [PricingEngine]
  [PortfolioPricer]
}

package &quot;Collateral &amp; Aggregation&quot; {
  [CSA]
  [CollateralEngine]
  [ExposureCube]
  [ExposureMetrics]
  [XVAEngine]
}

package &quot;Validation &amp; Backtesting&quot; {
  [Backtest]
  [StatsTests]
  [PricerBenchmark]
}

package &quot;Reporting&quot; {
  [ReportExporter]
  [DocGenerator]
}

[EngineRunner] --&gt; [RunConfig]
[EngineRunner] --&gt; [MarketDataEnvironment]
[EngineRunner] --&gt; [SimulationDriver]
[EngineRunner] --&gt; [PortfolioPricer]
[EngineRunner] --&gt; [CollateralEngine]
[EngineRunner] --&gt; [ExposureMetrics]
[EngineRunner] --&gt; [XVAEngine]
[EngineRunner] --&gt; [Backtest]
[EngineRunner] --&gt; [ReportExporter]

[MarketDataEnvironment] &lt;-- [MarketDataSource]

[SimulationDriver] --&gt; [RiskFactorModel]
[SimulationDriver] --&gt; [CorrelationModel]
[SimulationDriver] --&gt; [TimeGrid]
[SimulationDriver] --&gt; [RiskFactorCube]

[PortfolioPricer] --&gt; [Instrument]
[PortfolioPricer] --&gt; [Portfolio]
[PortfolioPricer] --&gt; [PricingEngine]
[PortfolioPricer] --&gt; [PricingContext]
[PortfolioPricer] --&gt; [RiskFactorCube]
[PortfolioPricer] --&gt; [ExposureCube]

[CollateralEngine] --&gt; [CSA]
[CollateralEngine] --&gt; [ExposureCube]

[ExposureMetrics] --&gt; [ExposureCube]
[XVAEngine] --&gt; [ExposureCube]

[Backtest] --&gt; [RiskFactorCube]
[Backtest] --&gt; [ExposureCube]
[Backtest] --&gt; [StatsTests]
[PricerBenchmark] --&gt; [PricingEngine]

[ReportExporter] --&gt; [ExposureCube]
[ReportExporter] --&gt; [RiskFactorCube]

&#64;enduml"/>

</object></p>
</section>
<section id="core-class-diagram">
<h2>Core Class Diagram<a class="headerlink" href="#core-class-diagram" title="Link to this heading"></a></h2>
<p class="plantuml">
<object data="_images/plantuml-8618b173797e6eeb2be287431deeed84bad6fd05.svg" type="image/svg+xml" style="width:2288px;height:315px;background:#FFFFFF;">
<img src="_images/plantuml-8618b173797e6eeb2be287431deeed84bad6fd05.png" alt="&#64;startuml Core_ClassDiagram

title Core API - Main Classes &amp; Relations

class RunConfig
class EngineRunner

class MarketDataEnvironment
interface MarketDataSource

class TimeGrid
class RiskFactorCube
class ExposureCube

interface RiskFactorModel
class CorrelationModel
class SimulationDriver

abstract class Instrument
class Portfolio
class PricingContext
interface PricingEngine
class PortfolioPricer

class CSA
class CollateralEngine
class ExposureMetrics
class XVAEngine

interface Backtest
class StatsTests
class ReportExporter

EngineRunner --&gt; RunConfig
EngineRunner --&gt; MarketDataSource
EngineRunner --&gt; MarketDataEnvironment
EngineRunner --&gt; SimulationDriver
EngineRunner --&gt; PortfolioPricer
EngineRunner --&gt; CollateralEngine
EngineRunner --&gt; ExposureMetrics
EngineRunner --&gt; XVAEngine
EngineRunner --&gt; Backtest
EngineRunner --&gt; ReportExporter

&#64;enduml"/>

</object></p>
</section>
<section id="orchestration-sequence">
<h2>Orchestration Sequence<a class="headerlink" href="#orchestration-sequence" title="Link to this heading"></a></h2>
<p class="plantuml">
<object data="_images/plantuml-b3edb7e6a76456b1659e19939e9d0790dfea6a1c.svg" type="image/svg+xml" style="width:1396px;height:806px;background:#FFFFFF;">
<img src="_images/plantuml-b3edb7e6a76456b1659e19939e9d0790dfea6a1c.png" alt="&#64;startuml EngineRunner_Sequence

title XVA / PFE Run - Orchestration Flow

actor User
participant EngineRunner
participant ConfigLoader
participant MarketDataSource
participant SimulationDriver
participant PortfolioPricer
participant CollateralEngine
participant ExposureMetrics
participant XVAEngine
participant Backtest
participant ReportExporter

User -&gt; EngineRunner: run(&quot;run_config.yaml&quot;)

EngineRunner -&gt; ConfigLoader: load(&quot;run_config.yaml&quot;)
ConfigLoader --&gt; EngineRunner: RunConfig

EngineRunner -&gt; MarketDataSource: get_snapshot(as_of)
MarketDataSource --&gt; EngineRunner: MarketDataEnvironment

EngineRunner -&gt; SimulationDriver: run(models, corr, time_grid, sim_cfg)
SimulationDriver --&gt; EngineRunner: RiskFactorCube

EngineRunner -&gt; PortfolioPricer: price_on_cube(portfolio, RiskFactorCube, PricingContext)
PortfolioPricer --&gt; EngineRunner: ExposureCube (uncollateralised)

EngineRunner -&gt; CollateralEngine: apply_csa(ExposureCube, CSA)
CollateralEngine --&gt; EngineRunner: ExposureCube (collateralised)

EngineRunner -&gt; ExposureMetrics: compute_EE/EPE/EEPE/PFE
ExposureMetrics --&gt; EngineRunner: ExposureMetricsResults

EngineRunner -&gt; XVAEngine: compute_XVA(CollateralisedCube, PD/LGD/etc.)
XVAEngine --&gt; EngineRunner: XVAResults

EngineRunner -&gt; Backtest: run()
Backtest --&gt; EngineRunner: BacktestResults

EngineRunner -&gt; ReportExporter: export_exposure/exposure_metrics/xva(...)
ReportExporter --&gt; EngineRunner: Files / Reports

EngineRunner --&gt; User: RunSummary

&#64;enduml"/>

</object></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Amine Badii.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>